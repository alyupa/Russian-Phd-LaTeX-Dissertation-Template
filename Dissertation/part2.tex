\chapter{Алгоритмы решения задач фильтрации} \label{ch:ch2}

\section{Алгоритм расчета классической модели фильтрации} \label{sec:ch2/sec1}

Найти точное общее решение системы уравнений ~\eqref{eq:classic_system} не представляется возможным в силу свойств системы, поэтому используем решение, полученное с помощью распространенного и проверенного на практике IMPES-метода с достаточно малым расчетным шагом по времени.
В этом случае имеем неявное разностное уравнение для давления (матрица коэффициентов трехдиагональная) и явное для насыщенности. Полученная СЛАУ решается итерационным численным методом.

\section{Алгоритм расчета КГД модели фильтрации} \label{sec:ch2/sec2}

Численное решение полученной системы уравнений разбито на~этапы. После
применения начальных условий на каждом шаге по времени выполняется следующая
последовательность действий: 
\begin{enumerate} 
\item Применение граничных условий.
\item Вычисление давлений $P_n$,
$P_g$ через $P_w$ и капиллярные давления. 
\item Вычисление плотностей фаз. 
\item
Нахождение относительных фазовых проницаемостей фаз и~вязкости.
\item Определение
коэффициентов в~законе Дарси для~фаз. 
\item 
\label{roS} 
Определение ${\rho}_iS_i$ на~
следующем временном шаге из~уравнения~\eqref{mass_mod}.
\item 
\label
{Newton} Решение нелинейной системы из~пяти уравнений методом Ньютона,
в результате чего находим $P_w$, $S_w$, $S_n$, $S_g$ на следующем шаге по~времени.
\item Сохранение полученных значений переменных в~текстовый файл
в~формате, подходящем для~визуализации.
\item Обмены данными при~многопроцессорных вычислениях.
\end{enumerate}
Для вычислений на шаге~\ref{roS} выбран класс явных двухслойных схем на равномерных декартовых сетках,
допускающих эффективное распараллеливание решения.
Рассмотрены две различные схемы:
\begin{itemize}
\item с направленными разностями;
\item с центральными разностями.
\end{itemize}

\section{Алгоритм расчета модели фильтрации с релаксацией потока массы} \label{sec:ch2/sec3}

Алгоритм расчета модели фильтрации с релаксацией потока массы аналогичен описанному в~\ref{sec:ch2/sec2}, за исключением того, что в рамках данной работы, он были применен к двухфазной модели фильтрации и для нахождения среднего давления из системы уравнений~\eqref{eq:mod_system} используется трехслойная явная разностная схема с центральными разностями. 
